# アーキテクチャ決定記録（ADR）

## ADR-001: Webフレームワークの選択

### 状況
- インスタグラムの投稿から自動的にハッシュタグを生成するWebアプリケーションの開発
- シンプルなAPI実装と静的ファイル配信が必要

### 決定
- **Flask**を採用

### 理由
1. 軽量で高速な開発が可能
2. シンプルなルーティングとAPI実装
3. 静的ファイル配信が容易
4. 拡張性が高い
5. Railway上での展開が容易

### 影響
- 開発の迅速化
- メンテナンスの容易さ
- スケーラビリティの確保

## ADR-002: UIフレームワークの選択

### 状況
- レスポンシブなUIが必要
- 迅速な開発が求められる
- カスタマイズ性が重要

### 決定
- **TailwindCSS**を採用（CDN経由）

### 理由
1. ユーティリティファーストのアプローチで開発が迅速
2. カスタマイズが容易
3. CDN経由で簡単に導入可能
4. モバイルファーストのレスポンシブデザイン
5. ビルドプロセス不要

### 影響
- 開発速度の向上
- 一貫したデザインの実現
- メンテナンスの容易さ

## ADR-003: 画像・テキスト解析サービスの選択

### 状況
- インスタグラム投稿の画像とテキストを解析する必要がある
- 高精度な解析が求められる
- 多言語対応（日本語・英語）が必要

### 決定
- **Requsty LLM Routing Service**を採用

### 理由
1. 高精度な画像認識機能
2. 自然言語処理による適切なハッシュタグ生成
3. 多言語対応
4. APIの使いやすさ
5. Railway上での環境変数管理が容易

### 影響
- 高品質なハッシュタグ生成
- スケーラブルな解析処理
- セキュアなAPI管理

## ADR-005: AIモデルとパラメータの選択

### 状況
- 画像認識と自然言語処理の両方が必要
- ハッシュタグ生成の精度が重要
- 適切なパラメータ設定が必要

### 決定
- **Anthropic Claude 3.5 Sonnet**モデル（anthropic/claude-3-5-sonnet-20241022）を採用
- 以下のパラメータを設定：
  * max_tokens: 1000
  * temperature: 0.7
  * hashtag_style: instagram

### 理由
1. GPT-4 Visionの選択理由
   - 高精度な画像認識能力
   - テキストと画像の文脈理解が優れている
   - マルチモーダル処理が可能

2. パラメータ設定の理由
   - max_tokens: 十分な長さのハッシュタグ生成を保証
   - temperature: 適度な創造性と関連性のバランス
   - hashtag_style: Instagram特有のスタイルに最適化

### 影響
- より正確なハッシュタグ生成
- 画像内容の深い理解
- Instagram文化に適したハッシュタグ生成

## ADR-004: デプロイ環境の選択

### 状況
- 安定したホスティング環境が必要
- 環境変数の管理が必要
- スケーラビリティが重要

### 決定
- **Railway**を採用

### 理由
1. Pythonアプリケーションの展開が容易
2. 環境変数の安全な管理
3. 自動デプロイの設定が容易
4. スケーリングが容易
5. 監視とログ管理が充実

### 影響
- 安定した運用環境の確保
- セキュアな環境変数管理
- 効率的なデプロイプロセス