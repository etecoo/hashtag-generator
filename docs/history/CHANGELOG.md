# 変更履歴

## [0.2.2] - 2025-02-07
### 改善
- CustomJSONDecoderの包括的な改善
  * 数値型の適切な処理（parse_float, parse_intの制御）
  * URL正規化処理の一元化（_normalize_url関数の追加）
  * デコード後の型変換の最適化

### バグ修正
- OpenAIクライアント初期化の問題を解決
  * 不要なproxiesパラメータを削除
  * タイムアウト設定の追加（30秒）
  * クライアント設定の最適化

### 技術的変更
- JSONデコード処理の強化
  * 数値データの一時的な文字列化と適切な復元
  * URL正規化処理の一貫性向上
  * デバッグログの詳細化

### 関連Issue
- [ISSUE-019] CustomJSONDecoderの改善とOpenAIクライアントの修正
- [ISSUE-018] カスタムJSONデコーダーの実装

[以下の変更履歴は変更なし]

## [0.2.1] - 2025-02-06
### 改善
- カスタムJSONデコーダーの実装によるセミコロン問題の解決
  * URLフィールドの特別な正規化処理
  * 多層的なデータ検証の導入
  * エンコーディング関連の問題対策

### 技術的な変更
- `CustomJSONDecoder`クラスの追加
  * 文字列パース処理の強化
  * URLに特化した正規化ロジック
  * 詳細なデバッグログの実装

### バグ修正
- JSONパース時のセミコロン混入問題を修正
- APIリクエストのエラー問題を解決

### 関連Issue
- [ISSUE-018] カスタムJSONデコーダーの実装
- [ISSUE-015] フロントエンド・バックエンド間の変換問題
- [ISSUE-017] request.get_json()の代替実装

## [0.2.0] - 2025-02-06
### 追加
- ドキュメント構造の改善
  * 新しいディレクトリ構造の導入
  * 文脈管理の効率化
  * トークン消費の最適化

### 変更
- ドキュメントの再編成
  * active/: 現在のセッション情報
  * core/: プロジェクトの基本情報
  * technical/: 技術文書
  * history/: 履歴管理

### ドキュメント
- CORE.mdの更新
- 新規ドキュメントの追加
  * CONTEXT.md
  * CURRENT.md

## [0.1.8] - 2025-02-06
### セキュリティ
- リクエストデータ処理の改善
  - request.get_json()の代替実装による安全性向上
  - 生データ検証の強化
  - セミコロン混入問題の解決

### 改善
- バックエンド処理の強化
  - 詳細なデバッグログの実装
  - エラーハンドリングの包括的な改善
  - リクエストデータの検証強化

- フロントエンド機能の改善
  - レスポンス処理の信頼性向上
  - デバッグ情報表示の体系化
  - エラーフィードバックの強化

### 技術的変更
- データ処理方法の変更
  - request.get_data(as_text=True)とjson.loads()の採用
  - レスポンスデータの型チェック強化
  - デバッグ情報の構造化

### セキュリティ
- リクエストデータの検証強化
  - JSONデータの妥当性検証を追加
  - 不正なデータ形式の早期検出機能を実装

### 改善
- URLクリーニング処理の追加強化
  - セミコロン除去処理の確実な実装
  - リクエストデータ構築時の検証強化
  - エラーハンドリングの改善

[以下、0.1.7以前の変更履歴は変更なし]

## [0.1.7] - 2025-02-06
### セキュリティ
- リクエストデータの検証強化
  - JSONデータの妥当性検証を追加
  - 不正なデータ形式の早期検出機能を実装

### 改善
- URLクリーニング処理の追加強化
  - セミコロン除去処理の確実な実装
  - リクエストデータ構築時の検証強化
  - エラーハンドリングの改善

## [0.1.6] - 2025-02-06
### 改善
- URLクリーニング処理の強化
  - 正規表現を使用してInstagramの基本URLのみを抽出するように改善
  - クエリパラメータを完全に除去する処理を追加
  - ログ出力の改善により、URL処理の追跡を容易に

- リクエストパラメータのログ出力を改善
  - JSON文字列化による問題を解消
  - より詳細で明確なログ形式を実装
  - デバッグ情報の可視性を向上

## [0.1.5] - 2025-02-06
### 改善
- フォーム送信処理のリファクタリングを実施
  - 匿名関数から明示的な名前付き関数 `generateHashtags` に変更
  - これにより、外部から `generateHashtags` 関数が参照可能となり、「ReferenceError: generateHashtags is not defined」エラーを解消
  - コードの可読性と再利用性が向上し、単体テスト等の将来的な拡張にも有利になる

## [0.1.4] - 2025-02-05
### 修正
- 環境変数名の修正
  - REQUSTY_API_KEY → REQUESTY_API_KEY（スペルミス修正）

### 改善
- APIリクエストのエラーハンドリング強化
  - タイムアウト設定（30秒）の追加
  - SSL証明書検証の明示的な有効化
  - 詳細なエラーメッセージの実装
  - ネットワークエラーの詳細なログ記録

## [0.1.3] - 2025-02-05
### 追加
- Requsty APIのAIモデル設定
  - Anthropic Claude 3.5 Sonnetモデル（anthropic/claude-3-5-sonnet-20241022）を指定
  - 最適なパラメータを設定：
    * max_tokens: 1000
    * temperature: 0.7
    * hashtag_style: instagram

### 技術的変更
- リクエストパラメータの最適化
- ログ出力の詳細化

## [0.1.2] - 2025-02-05
### 改善
- エラーハンドリングの強化
  - APIキーの存在チェックを追加
  - Instagram URLのバリデーション実装
  - Requstyからのエラーメッセージの詳細取得
- ロギング機能の実装
  - リクエスト情報のログ記録
  - レスポンスステータスのログ記録
  - エラー詳細のログ記録

### セキュリティ
- URLバリデーションの追加
  - Instagram投稿URLの形式チェック
  - 必須パラメータの検証

## [0.1.1] - 2025-02-05
### 更新
- Requsty API設定の更新
  - エンドポイントを実際のURLに更新（https://router.requesty.ai/v1）
  - 環境変数`REQUSTY_API_KEY`の設定をRailway用に準備

### 追加
- Railway用のデプロイ設定
  - Procfileの作成
  - gunicornによるプロダクション用サーバー設定

### Railway設定情報
- ビルドコマンド: `pip install -r requirements.txt`
- スタートコマンド: Procfileに定義（`gunicorn app:app`）
- 環境変数:
  - REQUSTY_API_KEY: Requsty APIキー

## [0.1.0] - 2025-02-05
### 追加
- プロジェクトの初期設定
  - Flaskアプリケーションの基本構造
  - 仮想環境の設定（/Users/ete/venvs/hashtag_generator）
  - 依存パッケージの設定（requirements.txt）

- フロントエンド実装
  - メインページのHTML実装（templates/index.html）
  - TailwindCSSの導入
  - JavaScriptによるフォーム処理（static/js/main.js）
  - カスタムスタイルの追加（static/css/style.css）

- バックエンド実装
  - Flaskルーティングの設定
  - Requesty LLM Service統合の準備
  - エラーハンドリングの実装

- ドキュメント作成
  - プロジェクト構造の文書化（00-CORE.md）
  - アーキテクチャ決定の記録（ADR.md）
  - システム設計の文書化（DESIGN.md）
  - 変更履歴の開始（CHANGELOG.md）

### 技術的変更
- Flask 3.0.2を採用
- TailwindCSSをCDN経由で導入
- RESTful APIエンドポイントの設計
- フォームバリデーションの実装
- クリップボード機能の実装

### セキュリティ
- 環境変数による設定管理の準備
- APIキーのセキュア管理の設定
- 入力値のバリデーション実装

### インフラ
- Railway用の設定準備
- 開発環境の構築